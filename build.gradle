import org.springframework.boot.gradle.plugin.SpringBootPlugin

/*
 * This file was generated by the Gradle 'init' task.
 */
plugins {
    id 'java'
    id 'maven-publish'
    id 'org.springframework.boot' version "${spring_boot_version}" apply false
}

allprojects {
    group = "com.atguigu.gulimall"
    version = '0.0.1-SNAPSHOT'

    repositories {
        mavenLocal()
        maven {
            url 'https://maven.aliyun.com/repository/public'
        }
        maven {
            url 'https://maven.aliyun.com/repository/spring'
        }
        maven {
            url 'https://maven.aliyun.com/repository/spring-plugin'
        }
        maven {
            url 'https://maven.aliyun.com/repository/gradle-plugin'
        }
        maven {
            url 'https://maven.aliyun.com/repository/google'
        }
        mavenCentral()
    }
}

subprojects {
    sourceCompatibility=1.8
    targetCompatibility=1.8
    assert System.properties["java.specification.version"] == "1.8" || "11" || "12" || "13" || "14"

    apply plugin: 'java'
    apply plugin: 'maven-publish'
    apply plugin: 'org.springframework.boot'

    dependencies {
        // 导入依赖BOM文件
        implementation platform(SpringBootPlugin.BOM_COORDINATES)
        implementation platform("org.springframework.cloud:spring-cloud-dependencies:${spring_cloud_version}")
        implementation platform("com.alibaba.cloud:spring-cloud-alibaba-dependencies:${spring_cloud_alibaba_version}")

        // Spring boot 依赖
        implementation 'org.springframework.boot:spring-boot-starter-actuator'
        implementation 'org.springframework.boot:spring-boot-configuration-processor'
        implementation 'org.springframework.boot:spring-boot-starter-data-redis'
        testImplementation 'org.springframework.boot:spring-boot-starter-test'

        // Spring cloud 依赖
        implementation 'org.springframework.cloud:spring-cloud-starter-openfeign'
        implementation 'org.springframework.cloud:spring-cloud-starter-zipkin'

        // Spring session 依赖
        implementation 'org.springframework.session:spring-session-data-redis'

        // Spring cloud alibaba 依赖
        implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-discovery'
        implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-nacos-config'
        implementation 'com.alibaba.cloud:spring-cloud-starter-alibaba-sentinel'
        implementation 'com.alibaba.csp:sentinel-spring-webmvc-adapter'

        // SQL Database
        implementation 'mysql:mysql-connector-java:8.0.17'
        testImplementation "com.h2database:h2"

        implementation 'com.baomidou:mybatis-plus-boot-starter:3.2.0'
        implementation 'redis.clients:jedis:3.1.0'
        implementation 'org.projectlombok:lombok:1.18.8'
        implementation 'org.apache.httpcomponents:fluent-hc:4.5.12'
        implementation 'commons-lang:commons-lang:2.6'
        implementation 'javax.validation:validation-api:2.0.1.Final'
        implementation 'org.hibernate.validator:hibernate-validator:6.1.5.Final'
        compileOnly 'javax.servlet:servlet-api:2.5'
    }

    publishing {
        publications {
            maven(MavenPublication) {
                from(components.java)
            }
        }
    }
}

wrapper {
    gradleVersion = "6.5"
}
